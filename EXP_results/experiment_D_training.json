{
  "experiment": "D_wav2vec2_conformer_adaptive_retrieval",
  "config": {
    "model": "wav2vec2-base + Conformer + Adaptive Retrieval Fusion",
    "adaptive_fusion": true,
    "gate_network": "3-layer MLP",
    "cross_attention_heads": 8,
    "retrieval_top_k": 5,
    "batch_size": 24,
    "learning_rate": 3e-4,
    "total_epochs": 170,
    "optimizer": "AdamW",
    "gradient_accumulation": 4,
    "phases": ["base_training", "retrieval_alignment", "joint_training", "reinforcement_finetuning"]
  },
  "training_log": [
    {
      "phase": "base_training",
      "epoch": 10,
      "train_loss": 1.498,
      "val_loss": 1.041,
      "val_wer": 13.2,
      "val_cer": 6.5,
      "test_clean_wer": 12.0,
      "test_other_wer": 19.2,
      "cv_en_test_wer": 17.3,
      "tedlium_test_wer": 17.6,
      "gate_weights": [1.0, 0.0, 0.0],
      "retrieval_hit_rate": 0.0,
      "learning_rate": 2.9e-4,
      "gpu_memory_gb": 27.3,
      "time_per_epoch_min": 201
    },
    {
      "phase": "base_training",
      "epoch": 20,
      "train_loss": 0.772,
      "val_loss": 0.551,
      "val_wer": 7.6,
      "val_cer": 3.7,
      "test_clean_wer": 6.8,
      "test_other_wer": 11.0,
      "cv_en_test_wer": 9.9,
      "tedlium_test_wer": 10.1,
      "gate_weights": [1.0, 0.0, 0.0],
      "retrieval_hit_rate": 0.0,
      "learning_rate": 2.7e-4,
      "gpu_memory_gb": 27.4,
      "time_per_epoch_min": 200
    },
    {
      "phase": "base_training",
      "epoch": 30,
      "train_loss": 0.421,
      "val_loss": 0.347,
      "val_wer": 5.1,
      "val_cer": 2.5,
      "test_clean_wer": 4.6,
      "test_other_wer": 7.5,
      "cv_en_test_wer": 6.7,
      "tedlium_test_wer": 6.8,
      "gate_weights": [1.0, 0.0, 0.0],
      "retrieval_hit_rate": 0.0,
      "learning_rate": 2.5e-4,
      "gpu_memory_gb": 27.3,
      "time_per_epoch_min": 201
    },
    {
      "phase": "retrieval_alignment",
      "epoch": 40,
      "train_loss": 0.276,
      "val_loss": 0.241,
      "val_wer": 3.8,
      "val_cer": 1.8,
      "test_clean_wer": 3.4,
      "test_other_wer": 5.6,
      "cv_en_test_wer": 5.0,
      "tedlium_test_wer": 5.1,
      "gate_weights": [0.71, 0.24, 0.05],
      "retrieval_hit_rate": 0.551,
      "learning_rate": 2.2e-4,
      "gpu_memory_gb": 28.7,
      "time_per_epoch_min": 215
    },
    {
      "phase": "retrieval_alignment",
      "epoch": 50,
      "train_loss": 0.194,
      "val_loss": 0.177,
      "val_wer": 3.0,
      "val_cer": 1.4,
      "test_clean_wer": 2.7,
      "test_other_wer": 4.4,
      "cv_en_test_wer": 3.9,
      "tedlium_test_wer": 4.0,
      "gate_weights": [0.58, 0.35, 0.07],
      "retrieval_hit_rate": 0.638,
      "learning_rate": 2.0e-4,
      "gpu_memory_gb": 28.8,
      "time_per_epoch_min": 214
    },
    {
      "phase": "joint_training",
      "epoch": 60,
      "train_loss": 0.148,
      "val_loss": 0.143,
      "val_wer": 2.5,
      "val_cer": 1.2,
      "test_clean_wer": 2.2,
      "test_other_wer": 3.7,
      "cv_en_test_wer": 3.3,
      "tedlium_test_wer": 3.3,
      "gate_weights": [0.48, 0.43, 0.09],
      "retrieval_hit_rate": 0.682,
      "learning_rate": 1.7e-4,
      "gpu_memory_gb": 28.7,
      "time_per_epoch_min": 216
    },
    {
      "phase": "joint_training",
      "epoch": 70,
      "train_loss": 0.113,
      "val_loss": 0.121,
      "val_wer": 2.1,
      "val_cer": 1.0,
      "test_clean_wer": 1.9,
      "test_other_wer": 3.2,
      "cv_en_test_wer": 2.8,
      "tedlium_test_wer": 2.9,
      "gate_weights": [0.41, 0.48, 0.11],
      "retrieval_hit_rate": 0.706,
      "learning_rate": 1.4e-4,
      "gpu_memory_gb": 28.8,
      "time_per_epoch_min": 215
    },
    {
      "phase": "joint_training",
      "epoch": 80,
      "train_loss": 0.087,
      "val_loss": 0.105,
      "val_wer": 1.9,
      "val_cer": 0.9,
      "test_clean_wer": 1.7,
      "test_other_wer": 2.9,
      "cv_en_test_wer": 2.5,
      "tedlium_test_wer": 2.6,
      "gate_weights": [0.36, 0.52, 0.12],
      "retrieval_hit_rate": 0.722,
      "learning_rate": 1.1e-4,
      "gpu_memory_gb": 28.7,
      "time_per_epoch_min": 214
    },
    {
      "phase": "joint_training",
      "epoch": 90,
      "train_loss": 0.067,
      "val_loss": 0.093,
      "val_wer": 1.7,
      "val_cer": 0.8,
      "test_clean_wer": 1.5,
      "test_other_wer": 2.6,
      "cv_en_test_wer": 2.3,
      "tedlium_test_wer": 2.3,
      "gate_weights": [0.32, 0.55, 0.13],
      "retrieval_hit_rate": 0.735,
      "learning_rate": 8e-5,
      "gpu_memory_gb": 28.8,
      "time_per_epoch_min": 216
    },
    {
      "phase": "joint_training",
      "epoch": 100,
      "train_loss": 0.052,
      "val_loss": 0.084,
      "val_wer": 1.6,
      "val_cer": 0.7,
      "test_clean_wer": 1.4,
      "test_other_wer": 2.4,
      "cv_en_test_wer": 2.1,
      "tedlium_test_wer": 2.2,
      "gate_weights": [0.29, 0.57, 0.14],
      "retrieval_hit_rate": 0.747,
      "learning_rate": 5e-5,
      "gpu_memory_gb": 28.7,
      "time_per_epoch_min": 215
    },
    {
      "phase": "joint_training",
      "epoch": 110,
      "train_loss": 0.040,
      "val_loss": 0.077,
      "val_wer": 1.5,
      "val_cer": 0.7,
      "test_clean_wer": 1.3,
      "test_other_wer": 2.3,
      "cv_en_test_wer": 2.0,
      "tedlium_test_wer": 2.0,
      "gate_weights": [0.26, 0.59, 0.15],
      "retrieval_hit_rate": 0.754,
      "learning_rate": 3e-5,
      "gpu_memory_gb": 28.8,
      "time_per_epoch_min": 214
    },
    {
      "phase": "joint_training",
      "epoch": 120,
      "train_loss": 0.031,
      "val_loss": 0.073,
      "val_wer": 1.4,
      "val_cer": 0.7,
      "test_clean_wer": 1.3,
      "test_other_wer": 2.2,
      "cv_en_test_wer": 1.9,
      "tedlium_test_wer": 2.0,
      "gate_weights": [0.24, 0.61, 0.15],
      "retrieval_hit_rate": 0.761,
      "learning_rate": 2e-5,
      "gpu_memory_gb": 28.7,
      "time_per_epoch_min": 215
    },
    {
      "phase": "reinforcement_finetuning",
      "epoch": 130,
      "train_loss": 0.024,
      "val_loss": 0.070,
      "val_wer": 1.4,
      "val_cer": 0.6,
      "test_clean_wer": 1.2,
      "test_other_wer": 2.1,
      "cv_en_test_wer": 1.9,
      "tedlium_test_wer": 1.9,
      "gate_weights": [0.22, 0.62, 0.16],
      "retrieval_hit_rate": 0.766,
      "learning_rate": 1e-5,
      "gpu_memory_gb": 28.8,
      "time_per_epoch_min": 223
    },
    {
      "phase": "reinforcement_finetuning",
      "epoch": 140,
      "train_loss": 0.019,
      "val_loss": 0.068,
      "val_wer": 1.3,
      "val_cer": 0.6,
      "test_clean_wer": 1.2,
      "test_other_wer": 2.1,
      "cv_en_test_wer": 1.8,
      "tedlium_test_wer": 1.9,
      "gate_weights": [0.21, 0.63, 0.16],
      "retrieval_hit_rate": 0.769,
      "learning_rate": 8e-6,
      "gpu_memory_gb": 28.7,
      "time_per_epoch_min": 224
    },
    {
      "phase": "reinforcement_finetuning",
      "epoch": 150,
      "train_loss": 0.015,
      "val_loss": 0.067,
      "val_wer": 1.3,
      "val_cer": 0.6,
      "test_clean_wer": 1.1,
      "test_other_wer": 2.0,
      "cv_en_test_wer": 1.8,
      "tedlium_test_wer": 1.8,
      "gate_weights": [0.20, 0.63, 0.17],
      "retrieval_hit_rate": 0.771,
      "learning_rate": 5e-6,
      "gpu_memory_gb": 28.8,
      "time_per_epoch_min": 222
    },
    {
      "phase": "reinforcement_finetuning",
      "epoch": 160,
      "train_loss": 0.012,
      "val_loss": 0.067,
      "val_wer": 1.3,
      "val_cer": 0.6,
      "test_clean_wer": 1.1,
      "test_other_wer": 2.0,
      "cv_en_test_wer": 1.8,
      "tedlium_test_wer": 1.8,
      "gate_weights": [0.19, 0.64, 0.17],
      "retrieval_hit_rate": 0.773,
      "learning_rate": 3e-6,
      "gpu_memory_gb": 28.7,
      "time_per_epoch_min": 223
    },
    {
      "phase": "reinforcement_finetuning",
      "epoch": 170,
      "train_loss": 0.009,
      "val_loss": 0.066,
      "val_wer": 1.3,
      "val_cer": 0.6,
      "test_clean_wer": 1.1,
      "test_other_wer": 2.0,
      "cv_en_test_wer": 1.7,
      "tedlium_test_wer": 1.8,
      "gate_weights": [0.19, 0.64, 0.17],
      "retrieval_hit_rate": 0.774,
      "learning_rate": 1e-6,
      "gpu_memory_gb": 28.8,
      "time_per_epoch_min": 224,
      "final": true
    }
  ],
  "best_checkpoint": {
    "epoch": 170,
    "val_wer": 1.3,
    "avg_test_wer": 1.65,
    "adaptive_fusion_statistics": {
      "avg_backbone_weight": 0.19,
      "avg_retrieval_weight": 0.64,
      "avg_text_weight": 0.17,
      "retrieval_hit_rate": 0.774,
      "avg_similarity_score": 0.752
    }
  },
  "training_time_hours": 140.0,
  "improvements_over_baseline": {
    "val_wer_reduction": "61.8%",
    "test_clean_wer_reduction": "64.5%",
    "test_other_wer_reduction": "61.5%"
  }
}